<!DOCTYPE html>
<html lang="en">
<head><title>Table of verses</title>

<!-- meta was recommended by microsoft edge dev tools -->
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- table styles -->
<style>
table, th, td {
  border: 1px solid black;
}

div.solid { border-style: solid; }

</style>

</head><body>
<!-- removed to auto load file
<button id="btn">If desired, select file named comfort.json</button>
-->
<p>The table of bible verses references underwent a minimum sort on book name. The numbers in the table are the original order, but are not in sequence after the minimum sort reordered them.</p>

<p id="author"></p>
<p id="date"></p>
<p id="bibleStudy"></p>

<table id="table1"><caption>Table placeholder</caption>
<tr translate=no>
	<th>Verse</th>
	<th>Text</th>
	</tr>
</table>


<p id="personal"></p>

<!-- removed as reader does not want to see it
	<p>statusFu: to status functions</p>
	<br><div id="statusFu" class="solid" translate="no">-</div>

	<p>statusErr: to status errors</p>
	<br><div id="statusErr" class="solid" translate="no">-</div>
-->

<script>
//example adapted from https://developer.chrome.com/docs/capabilities/web-apis/file-system-access#read-file
let fileHandle; //used by listeners when selecting file

//const body = document.body; //body element
const body = document.body;
//variables when opening first iteration of tanach.us files, reformatted to json
	const tab1 = document.getElementById('table1'); //id of the button.
		const tBdy = tab1.querySelector('tbody');
		const tCap = tab1.querySelector('caption');

const author  = document.getElementById('author');
const date  = document.getElementById('date');
const bibleStudy  = document.getElementById('bibleStudy');
const personal = document.getElementById('personal');

</script>
<script>

// Function to safely convert text to integer
function textToInteger(text) {
    if (typeof text !== "string") {
        throw new TypeError("Input must be a string.");
    }

    // Trim whitespace
    const trimmed = text.trim();

    // Attempt conversion
    const num = parseInt(trimmed, 10); // base 10

    // Validate result
    if (isNaN(num)) {
        throw new Error(`"${text}" is not a valid integer.`);
    }

    return num;
}


function loadTbl(jD) { //jsonData (jD)
	try {
	//alert("starting loadTbl(), it only loads one row to start for debugging.");	//return

	tBdy.innerHTML = '';	// Clear existing rows in tbody
	//return `Hello, ${name}!`;
	for (let key in jD) {
		//alert("key=" + key + ", data=" + jsonData[key]);
		/* The AI said the File System API does not report directory path. Therefore, operator may have to do second selection of bibliography
		if (key == "book") {
			//alert("book=" + jsonData[key]);
			caption.innerText = jD[key];
		*/
	switch(key) {
		case 'caption':
 			tCap.innerText = jD[key];
			break;
		case 'author':
			author.innerHTML  = key + ': ' + jD[key];
			break;
		case 'date':
			date.innerHTML = key + ': ' + jD[key];
			break;
		case 'bibleStudy':
			bibleStudy.innerHTML  = key + ': ' + jD[key];
			break;
		case 'verses':
			for (let key2 in jD[key]) {
				const row = document.createElement('tr');
				const verseNo = document.createElement('td');
				verseNo.textContent = textToInteger(key2) + 1;

				const basicTxt = JSON.stringify(jD[key][key2]);
				const strippedString = basicTxt.slice(1, -1); //remove quotes off front and back. JSON.stringify added them to value
				//const strippedString = basicTxt;

        		const verseText = document.createElement('td');
        		verseText.textContent = strippedString;

				row.appendChild(verseNo);
        		row.appendChild(verseText);
        		table1.appendChild(row);
			}
			break;

		case 'personal':
			personal.innerHTML = key + ': ' + jD[key];
			break;
			
		default:
			statusFu.innerHTML += '<br><br>unexpected key' + key;
			break;
	}
		/*
		if (key >=1 ) {
			return; //keep loop short for debugging
			}
		*/
  } //end for
  } catch (error) {
    // Handle the error
	statusErr.innerHTML += 
    alert("loadTblTUS() caught an error: " + error.message);
  }
}


</script>

<script>
function sortTable(n) {
	//be able to sort the scriptures at minimum by book name
	var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
	//use tab1 instead of table = document.getElementById("myTable");
	switching = true;
	dir = "asc";
	while (switching) {
		switching = false; 
		rows = tab1.rows; 
		for (i = 0; i < (rows.length - 1); i++) { 
			shouldSwitch = false; 
			x = rows[i].getElementsByTagName("TD")[n]; 
			y = rows[i + 1].getElementsByTagName("TD")[n]; 
			if (dir == "asc") { 
				if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) { 
					shouldSwitch = true; break; 
					}
			} else if (dir == "desc") {
				if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
					shouldSwitch = true;
					break;
					} 
			} 
		} 
		if (shouldSwitch) { 
			rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
			switching = true;
			switchcount++;
		} else {
			if (switchcount == 0 && dir == "asc") {
				dir = "desc";
				switching = true;
				}
			}
		}
	}
</script>

<script>
const comfort = `{
	"caption": "Bible Verses of Comfort",
	"author": "Pr Dave Siu",
	"date": "24 Oct 2025",
	"bibleStudy": "Ohana bible study",
	"verses": [
		"Psa 61:1-2",
		"Psa 62:1-2, 5-8",
		"Psa 91:1-2",
		"Psa 145:8-9",
		"Isa 40:28-31",
		"2Pe 1:3-4",
		"2Co 4:16-18",
		"2Co 1:3-4",
		"Isa 50:10",
		"Psa 23:1-4",
		"Psa 103:1-5",
		"Psa 136:1-5",
		"Jer 5:22" ,
		"Ecc 3:11",
		"Lam 3:22-25",
		"1Pe 2:9-10",
		"2Ti 2:3-4",
		"Est 4:14",
		"Mt 25:21",
		"Isa 55:8-9",
		"1Sa 16:7",
		"Heb 13:5",
		"Rom 8:26-27",
		"Heb 13:8",
		"Rom 8:16-18",
		"Heb 12:14",
		"Psa 121:1-2",
		"1Sa 2:2-3",
		"Jos 1:9",
		"Rom 8:11",
		"Rom 8:28-30",
		"Rom 8:31-39",
		"1Co 15:10-11",
		"Psa 100:1-3",
		"Psa 90:1-2",
		"Psa 42:1-3",
		"Psa 56:8",
		"Psa 34:17-19",
		"Psa 139:1-4",
		"Psa 139:17-18",
		"John 16:33",
		"Isa 41:10",
		"Isa 40:31",
		"Psa 118:6",
		"1Pe 5:6-7",
		"Phi 1:6",
		"2Co 12:9-10",
		"Gen 22:8",
		"Mat 6:33",
		"1Ti 6:17-19",
		"Mat 7:13-14",
		"Luk 13:6-9",
		"John 10:27-30",
		"John 19:30",
		"Luk 23:42-43",
		"Pro 16:7",
		"Psa 119:50",
		"Luke 22:31-32",
		"Psa 147:3",
		"Psa 119:71",
		"Rom 15:13"
		],
	"personal": "Your favorite verses that bring you comfort [fill in the blanks] _______________________________________________________________"
}`;
</script><script>


//removed after converting to autoload of js variable
/*
	btn.addEventListener('click', async () => {
  	[fileHandle] = await window.showOpenFilePicker({
    	types: [
        	{
          	description: 'JSON Files',
          	accept: { 'application/json': ['.json'] },
        	},
      	],
    	});
  	const file = await fileHandle.getFile();
  	const contents = await file.text();
  	const jsonData = JSON.parse(contents);
  	loadTbl(jsonData); //example scripture file from an AI
	});
*/

// Add event listener with arguments using an arrow function wrapper
body.onload = function() {
	try {
		const comfortData = JSON.parse(comfort);
		loadTbl(comfortData);
		sortTable(1);
	} catch (error) {
    // Handle the error 
    	alert("body.onload caught an error: " + error.message);
  	}
};


</script>

</body></html>